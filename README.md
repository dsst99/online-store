üöÄ Online Store
--------------------------------------------------------------------------------------------------

Django + DRF + Celery + Memcached
--------------------------------------------------------------------------------------------------

‚ö° –°—Ç–µ–∫
--------------------------------------------------------------------------------------------------

- Django 5.x + DRF ‚Äî REST API

- PostgreSQL (prod) / SQLite (dev)

- Redis + Celery ‚Äî —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (PDF, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)

- Memcached ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –∏ –¥–µ—Ç–∞–ª–µ–π

- JWT (SimpleJWT) ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- drf-spectacular ‚Äî OpenAPI / Swagger / Redoc

- pytest + pytest-django ‚Äî —Ç–µ—Å—Ç—ã

--------------------------------------------------------------------------------------------------
üõ† –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (–ª–æ–∫–∞–ª—å–Ω–æ)

# –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
--------------------------------------------------------------------------------------------------

# –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

python manage.py migrate
python manage.py createsuperuser
--------------------------------------------------------------------------------------------------

# –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã

redis-server # –±—Ä–æ–∫–µ—Ä –¥–ª—è Celery
memcached -vv # –∫—ç—à
celery -A online_store worker -l info
python manage.py runserver
--------------------------------------------------------------------------------------------------
üê≥ Docker Compose

# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

docker compose up --build

# –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

docker compose exec web python manage.py migrate
docker compose exec web python manage.py createsuperuser
--------------------------------------------------------------------------------------------------
‚öôÔ∏è –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

AUTH_USER_MODEL = "users.User"

REST_FRAMEWORK["DEFAULT_AUTHENTICATION_CLASSES"] = (
"rest_framework_simplejwt.authentication.JWTAuthentication",
)

CACHES = {
"default": {
"BACKEND": "django.core.cache.backends.memcached.PyMemcacheCache",
"LOCATION": "127.0.0.1:11211",
}
}

--------------------------------------------------------------------------------------------------
üîó API
Users (apps/users)
| Endpoint | Method | Description |
| ------------------------ | ------ | --------------------------------------- |
| `/api/v1/auth/register/` | POST | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è {username, email, password} |
| `/api/v1/auth/login/`    | POST | JWT {access, refresh} |
| `/api/v1/auth/refresh/`  | POST | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access –ø–æ refresh |
-------------------------------------------------------------------------------

--------------------------------------------------------------------------------------------------------
Catalog
| Endpoint | Method | Description |
| ------------------------------------- | ------ | ---------------------------------------------------- |
| `/api/v1/categories/?search=`         | GET | –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –∫—ç—à 5 –º–∏–Ω |
| `/api/v1/categories/{id}/`            | GET | –î–µ—Ç–∞–ª—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∫—ç—à 5 –º–∏–Ω |
| `/api/v1/categories/{id}/?hard=true`  | DELETE | Hard delete ‚Äî —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω –∏ –±–µ–∑ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ |
| `/api/v1/products/?search=&category=` | GET | –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –∫—ç—à 5 –º–∏–Ω |
| `/api/v1/products/{id}/`              | GET | –î–µ—Ç–∞–ª—å –ø—Ä–æ–¥—É–∫—Ç–∞, –∫—ç—à 5 –º–∏–Ω |
---------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------------------------------------
Orders (JWT required)
| Endpoint | Method | Description |
| ----------------------- | ------ | ---------------------------------------------------------------------- |
| `/api/v1/orders/`       | GET | –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫—ç—à 60—Å |
| `/api/v1/orders/`       | POST | –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è, select\_for\_update, Celery: PDF + email) |
| `/api/v1/orders/{id}/`  | GET | –î–µ—Ç–∞–ª—å –∑–∞–∫–∞–∑–∞ (–≤–ª–∞–¥–µ–ª–µ—Ü/–∞–¥–º–∏–Ω), –∫—ç—à 60—Å |
| `/api/v1/orders/{id}/`  | PATCH | –°–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å–∞ (–≤–∞–ª–∏–¥–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã; shipped ‚Üí Celery API call)           |
| `/api/v1/admin/orders/` | GET | –ê–¥–º–∏–Ω-—Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏, –∫—ç—à 60—Å |
-------------------------------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------------------
–ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏ stock (HTTP 400):
{
"stock": "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ",
"details": [{"product_id": 1, "available": 2, "requested": 5}]
}

--------------------------------------------------------------------------------------------------
üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

/api/schema/ ‚Äî OpenAPI schema

/api/schema/swagger-ui/ ‚Äî Swagger UI

/api/schema/redoc/ ‚Äî Redoc
--------------------------------------------------------------------------------------------------

‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- –ö–∞—Ç–∞–ª–æ–≥: –º–æ–¥–µ–ª–∏, API, —Ñ–∏–ª—å—Ç—Ä—ã, –∫—ç—à, —Å–∏–≥–Ω–∞–ª—ã, —Ç–µ—Å—Ç—ã

- –ó–∞–∫–∞–∑—ã: –º–æ–¥–µ–ª–∏, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, select_for_update, API, Celery-–∑–∞–¥–∞—á–∏, –∫—ç—à, —Ç–µ—Å—Ç—ã

- JWT: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, refresh

- drf-spectacular: Swagger / Redoc

- pytest: –∫–∞—Ç–∞–ª–æ–≥, –∑–∞–∫–∞–∑—ã, users + auth flow

--------------------------------------------------------------------------------------------------

üß™ –¢–µ—Å—Ç—ã

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –∫–æ—Ä–Ω–µ–≤–æ–π conftest.py (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ email, get_user_model())


--------------------------------------------------------------------------------------------------

| –ö–æ–º–∞–Ω–¥–∞                   | –û–ø–∏—Å–∞–Ω–∏–µ                                             |
|---------------------------|------------------------------------------------------|
| `pytest -q`               | –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤                                   |
| `pytest apps/catalog/ -q` | –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∫–∞—Ç–∞–ª–æ–≥–∞                               |
| `pytest apps/orders/ -q`  | –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∑–∞–∫–∞–∑–æ–≤                                |
| `pytest apps/users/ -q`   | –¢–µ—Å—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –ª–æ–≥–∏–Ω–∞, refresh –∏ –¥–æ—Å—Ç—É–ø –∫ orders |

--------------------------------------------------------------------------------------------------
